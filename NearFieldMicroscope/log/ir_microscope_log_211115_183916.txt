2021-11-15T18:39:17|INFO|HydraHarpOptimizerMeasure|hydraharp_channel_optimizer start_stop False
2021-11-15T18:39:17|INFO|HydraHarpOptimizerMeasure|measurement hydraharp_channel_optimizer stopping stop_first
2021-11-15T18:39:17|INFO|HydraHarpHistogramMeasure|hydraharp_histogram start_stop False
2021-11-15T18:39:17|INFO|HydraHarpHistogramMeasure|measurement hydraharp_histogram stopping stop_first
2021-11-15T18:39:17|INFO|PowerScanMeasure|power_scan start_stop False
2021-11-15T18:39:17|INFO|PowerScanMeasure|measurement power_scan stopping stop_first
2021-11-15T18:39:17|INFO|PowerMeterOptimizerMeasure|powermeter_optimizer start_stop False
2021-11-15T18:39:17|INFO|PowerMeterOptimizerMeasure|measurement powermeter_optimizer stopping stop_first
2021-11-15T18:39:17|INFO|APDOptimizerCBMeasurement|apd_optimizer start_stop False
2021-11-15T18:39:17|INFO|APDOptimizerCBMeasurement|measurement apd_optimizer stopping stop_first
2021-11-15T18:39:18|INFO|NearFieldMicroscope|setting up figures for hydraharp_channel_optimizer measurement hydraharp_channel_optimizer
2021-11-15T18:39:18|INFO|HydraHarpOptimizerMeasure|hydraharp_channel_optimizer start_stop False
2021-11-15T18:39:18|INFO|HydraHarpOptimizerMeasure|measurement hydraharp_channel_optimizer stopping stop_first
2021-11-15T18:39:18|INFO|NearFieldMicroscope|setting up figures for hydraharp_histogram measurement hydraharp_histogram
2021-11-15T18:39:18|INFO|NearFieldMicroscope|setting up figures for power_scan measurement power_scan
2021-11-15T18:39:18|INFO|PowerScanMeasure|power_scan start_stop False
2021-11-15T18:39:18|INFO|PowerScanMeasure|measurement power_scan stopping stop_first
2021-11-15T18:39:18|INFO|NearFieldMicroscope|setting up figures for powermeter_optimizer measurement powermeter_optimizer
2021-11-15T18:39:18|INFO|PowerMeterOptimizerMeasure|powermeter_optimizer start_stop False
2021-11-15T18:39:18|INFO|PowerMeterOptimizerMeasure|measurement powermeter_optimizer stopping stop_first
2021-11-15T18:39:18|INFO|NearFieldMicroscope|setting up figures for apd_optimizer measurement apd_optimizer
2021-11-15T18:39:18|INFO|APDOptimizerCBMeasurement|apd_optimizer start_stop False
2021-11-15T18:39:18|INFO|APDOptimizerCBMeasurement|measurement apd_optimizer stopping stop_first
2021-11-15T18:39:18|INFO|NearFieldMicroscope|ini settings loading from near_field_microscope_defaults.ini
2021-11-15T18:39:18|INFO|NearFieldMicroscope|hardware/hydraharp
2021-11-15T18:39:18|INFO|NearFieldMicroscope|hardware/pololu_maestro
2021-11-15T18:39:18|CRITICAL|root|Unhandled exception:Traceback (most recent call last):
  File "C:\Users\RAMAN\workspace\NearField\ScopeFoundry\logged_quantity.py", line 842, in update_math
    new_val = self.math_func(*lq_vals)
  File "C:\Users\RAMAN\workspace\NearField\ScopeFoundryHW\pololu_servo\multi_servo_hw.py", line 36, in <lambda>
    func=lambda raw, rmin, rmax, scale: scale*( (raw - rmin)/(rmax-rmin) ),
ZeroDivisionError: float division by zero

2021-11-15T18:39:21|INFO|NearFieldMicroscope|hardware/power_wheel
2021-11-15T18:39:21|INFO|NearFieldMicroscope|hardware/thorlabs_powermeter
2021-11-15T18:39:21|INFO|NearFieldMicroscope|hardware/apd_counter
2021-11-15T18:39:21|INFO|NearFieldMicroscope|ini settings loaded from: near_field_microscope_defaults.ini
2021-11-15T18:39:24|DEBUG|ScopeFoundryHW.ni_daq.devices.ni_counter_task|NI_CounterTask.set_channel-- Dev1/ctr0 /Dev1/PFI0
2021-11-15T18:39:24|CRITICAL|root|Unhandled exception:Traceback (most recent call last):
  File "C:\Users\RAMAN\workspace\NearField\ScopeFoundryHW\ni_daq\devices\ni_task_wrap.py", line 52, in start
    self.task.StartTask()
  File "<string>", line 3, in StartTask
  File "<string>", line 2, in function
  File "C:\ProgramData\Anaconda3\lib\site-packages\PyDAQmx\DAQmxFunctions.py", line 62, in mafunction
    raise exception_class(errBuff.value.decode("utf-8"), f.__name__)
PyDAQmx.DAQmxFunctions.PALUSBTransactionErrorError: A USB transfer failed due to a transaction error reported by the USB host controller.  This may be due to a fault in the system's USB host controller, a USB cable, or a USB device.
Task Name: _unnamedTask<0>

Status Code: -50808
 in function DAQmxStartTask

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\RAMAN\workspace\NearField\ScopeFoundry\hardware.py", line 220, in enable_connection
    raise err
  File "C:\Users\RAMAN\workspace\NearField\ScopeFoundry\hardware.py", line 210, in enable_connection
    self.connect()
  File "C:\Users\RAMAN\workspace\NearField\ScopeFoundryHW\ni_daq\hw\ni_freq_counter_callback.py", line 66, in connect
    self.restart_task()
  File "C:\Users\RAMAN\workspace\NearField\ScopeFoundryHW\ni_daq\hw\ni_freq_counter_callback.py", line 128, in restart_task
    C.start()
  File "C:\Users\RAMAN\workspace\NearField\ScopeFoundryHW\ni_daq\devices\ni_counter_task.py", line 81, in start
    NI_TaskWrap.start(self)
  File "C:\Users\RAMAN\workspace\NearField\ScopeFoundryHW\ni_daq\devices\ni_task_wrap.py", line 54, in start
    self.error(err)
  File "C:\Users\RAMAN\workspace\NearField\ScopeFoundryHW\ni_daq\devices\ni_task_wrap.py", line 42, in error
    logger.error('Error calling "{}": {}'.format( err.fname, err.mess ))
AttributeError: 'PALUSBTransactionErrorError' object has no attribute 'mess'

2021-11-15T18:40:11|DEBUG|ScopeFoundryHW.ni_daq.devices.ni_counter_task|NI_CounterTask.set_channel-- Dev1/ctr0 /Dev1/PFI0
2021-11-15T18:40:11|CRITICAL|root|Unhandled exception:Traceback (most recent call last):
  File "C:\Users\RAMAN\workspace\NearField\ScopeFoundryHW\ni_daq\devices\ni_task_wrap.py", line 52, in start
    self.task.StartTask()
  File "<string>", line 3, in StartTask
  File "<string>", line 2, in function
  File "C:\ProgramData\Anaconda3\lib\site-packages\PyDAQmx\DAQmxFunctions.py", line 62, in mafunction
    raise exception_class(errBuff.value.decode("utf-8"), f.__name__)
PyDAQmx.DAQmxFunctions.PALUSBTransactionErrorError: A USB transfer failed due to a transaction error reported by the USB host controller.  This may be due to a fault in the system's USB host controller, a USB cable, or a USB device.
Task Name: _unnamedTask<1>

Status Code: -50808
 in function DAQmxStartTask

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\RAMAN\workspace\NearField\ScopeFoundry\hardware.py", line 220, in enable_connection
    raise err
  File "C:\Users\RAMAN\workspace\NearField\ScopeFoundry\hardware.py", line 210, in enable_connection
    self.connect()
  File "C:\Users\RAMAN\workspace\NearField\ScopeFoundryHW\ni_daq\hw\ni_freq_counter_callback.py", line 66, in connect
    self.restart_task()
  File "C:\Users\RAMAN\workspace\NearField\ScopeFoundryHW\ni_daq\hw\ni_freq_counter_callback.py", line 128, in restart_task
    C.start()
  File "C:\Users\RAMAN\workspace\NearField\ScopeFoundryHW\ni_daq\devices\ni_counter_task.py", line 81, in start
    NI_TaskWrap.start(self)
  File "C:\Users\RAMAN\workspace\NearField\ScopeFoundryHW\ni_daq\devices\ni_task_wrap.py", line 54, in start
    self.error(err)
  File "C:\Users\RAMAN\workspace\NearField\ScopeFoundryHW\ni_daq\devices\ni_task_wrap.py", line 42, in error
    logger.error('Error calling "{}": {}'.format( err.fname, err.mess ))
AttributeError: 'PALUSBTransactionErrorError' object has no attribute 'mess'

2021-11-15T18:40:45|DEBUG|ScopeFoundryHW.ni_daq.devices.ni_counter_task|NI_CounterTask.set_channel-- Dev1/ctr0 /Dev1/PFI0
2021-11-15T18:40:50|DEBUG|ScopeFoundryHW.thorlabs_powermeter.thorlabs_pm100d|get_auto_range '1\n'
2021-11-15T18:40:50|DEBUG|ScopeFoundryHW.thorlabs_powermeter.thorlabs_pm100d|get_auto_range '1\n'
2021-11-15T18:41:04|DEBUG|ScopeFoundryHW.ni_daq.devices.ni_counter_task|NI_CounterTask.set_channel-- Dev1/ctr0 /Dev1/PFI0
2021-11-15T18:41:20|INFO|PowerScanMeasure|power_scan start_stop True
2021-11-15T18:41:20|INFO|PowerScanMeasure|measurement power_scan start called from thread: 10560
2021-11-15T18:41:31|INFO|PowerScanMeasure|data saved C:\Users\RAMAN\workspace\NearField\NearFieldMicroscope\data\211115_184131_power_scan.h5
2021-11-15T18:41:33|INFO|PowerScanMeasure|power_scan start_stop False
2021-11-15T18:41:33|INFO|PowerScanMeasure|measurement power_scan stopping run_post_run
2021-11-15T18:41:33|INFO|PowerScanMeasure|measurement power_scan interrupt called
2021-11-16T12:04:45|DEBUG|root|close
2021-11-16T12:04:49|DEBUG|root|closing
2021-11-16T12:04:49|INFO|NearFieldMicroscope|on_close
2021-11-16T12:04:49|INFO|NearFieldMicroscope|disconnecting hydraharp
2021-11-16T12:04:49|INFO|NearFieldMicroscope|disconnecting pololu_maestro
2021-11-16T12:04:49|INFO|NearFieldMicroscope|disconnecting power_wheel
2021-11-16T12:04:49|INFO|NearFieldMicroscope|disconnecting thorlabs_powermeter
2021-11-16T12:04:49|INFO|NearFieldMicroscope|disconnecting apd_counter
